{
  "$schema": "../../packages/config/jeju-manifest.schema.json",
  "name": "oauth3",
  "displayName": "OAuth3 Authentication Gateway",
  "version": "1.0.0",
  "type": "service",
  "description": "Decentralized authentication gateway for Jeju Network. Provides OAuth3 login flows for wallet, Farcaster, and social providers. Acts as a passthrough for other apps.",
  "commands": {
    "dev": "bun run dev",
    "build": "bun run build",
    "start": "bun run start",
    "test": "bun run test"
  },
  "ports": {
    "main": 4200,
    "frontend": 4201
  },
  "dependencies": [
    "contracts",
    "config"
  ],
  "optional": false,
  "enabled": true,
  "autoStart": true,
  "tags": [
    "auth",
    "oauth3",
    "login",
    "identity",
    "passthrough",
    "mpc",
    "tee"
  ],
  "jns": {
    "name": "auth.jeju",
    "description": "OAuth3 Authentication Gateway",
    "url": "https://auth.jejunetwork.org"
  },
  "healthCheck": {
    "url": "http://localhost:4200/health",
    "interval": 30000
  },
  "agent": {
    "enabled": true,
    "a2aEndpoint": "/a2a",
    "mcpEndpoint": "/mcp",
    "tags": [
      "jeju-app",
      "auth",
      "oauth3",
      "identity"
    ],
    "metadata": {
      "category": "auth",
      "provider": "jeju-network",
      "features": [
        "oauth3",
        "mpc-signing",
        "session-management",
        "verifiable-credentials"
      ]
    },
    "trustModels": [
      "open",
      "staked"
    ],
    "x402Support": false,
    "jnsName": "auth.jeju"
  },
  "dws": {
    "backend": {
      "enabled": true,
      "runtime": "bun",
      "entrypoint": "api/index.ts",
      "memory": 256,
      "timeout": 30000,
      "minInstances": 2,
      "maxInstances": 10,
      "teeRequired": true,
      "regions": [
        "global"
      ]
    },
    "cdn": {
      "enabled": true,
      "regions": [
        "global"
      ],
      "staticDir": "dist/web",
      "cacheRules": [
        {
          "pattern": "/assets/**",
          "ttl": 31536000,
          "immutable": true
        },
        {
          "pattern": "/*.js",
          "ttl": 86400
        },
        {
          "pattern": "/*.css",
          "ttl": 86400
        },
        {
          "pattern": "/**/*.html",
          "ttl": 60,
          "staleWhileRevalidate": 3600
        }
      ]
    }
  },
  "services": {
    "auth": {
      "type": "oauth3",
      "providers": [
        "wallet",
        "farcaster",
        "github",
        "google",
        "twitter",
        "discord",
        "apple",
        "email",
        "phone"
      ],
      "mpcCluster": "default",
      "teeRequired": true
    },
    "secrets": {
      "type": "kms",
      "provider": "mpc"
    }
  },
  "decentralization": {
    "worker": {
      "name": "oauth3-api",
      "entrypoint": "api/worker.ts",
      "runtime": "workerd",
      "memory": 256,
      "timeout": 30000,
      "compatibilityDate": "2024-01-01",
      "compatibilityFlags": [
        "nodejs_compat"
      ],
      "routes": [
        {
          "pattern": "/api/*"
        },
        {
          "pattern": "/oauth/*"
        },
        {
          "pattern": "/callback/*"
        },
        {
          "pattern": "/health"
        }
      ]
    },
    "frontend": {
      "buildDir": "dist/web",
      "buildCommand": "bun run build",
      "spa": true,
      "jnsName": "auth.jeju",
      "ipfs": true,
      "arweave": true
    },
    "cdn": {
      "enabled": true,
      "regions": [
        "global"
      ],
      "cacheRules": [
        {
          "pattern": "/assets/**",
          "ttl": 31536000,
          "immutable": true
        },
        {
          "pattern": "/api/**",
          "ttl": 0
        },
        {
          "pattern": "/**/*.html",
          "ttl": 60,
          "staleWhileRevalidate": 3600
        }
      ],
      "serviceWorker": true
    },
    "robustness": {
      "multiOrigin": true,
      "offlineSupport": false,
      "p2pFallback": true,
      "contentAddressed": true
    }
  },
  "testing": {
    "e2e": {
      "command": "bunx playwright test tests/",
      "config": "playwright.config.ts",
      "timeout": 180000,
      "requiresChain": false
    },
    "synpress": {
      "command": "synpress run --config synpress.config.ts",
      "timeout": 180000,
      "requiresChain": true,
      "requiresWallet": true
    }
  },
  "architecture": {
    "type": "hybrid",
    "frontend": {
      "type": "spa",
      "builder": "bun",
      "entrypoint": "index.html",
      "outputDir": "dist/web"
    }
  }
}
